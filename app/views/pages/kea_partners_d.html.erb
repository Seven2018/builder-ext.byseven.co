<div class="container-seven-large-form">
  <div id='attendee-form-logo'>
    <%= image_tag "SEVENLOGO_SQUARE2.png" %>
    <img src="https://media.glassdoor.com/sqll/365366/kea-and-partners-squarelogo-1466439693008.png" alt="" >
  </div>
  <% training = Training.find_by(refid: '20-0088') %>
  <% sessions = training.sessions.sort_by{|x|x.id} %>
  <% if params[:search].present? %>
    <% attendee = Attendee.find_by(email: params[:search][:email]) %>
  <% end %>
  <div id='attendee-form'>
    <% status = !params[:search].nil? %>
    <div id="attendee-form-title">
      <h1>Formulaire d'inscription</h1>
      <br>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non consectetur dolor. Donec viverra id libero nec finibus. Aliquam condimentum nec ante tristique euismod.</p>
      <h2 style='color: #FFC451;'><strong></strong></h2>
    </div>
    <% if !user_signed_in? %>
      <%= simple_form_for :search, url: kea_partners_d_path, method: 'GET' do |f| %>
        <% if status && !Attendee.where(email: params[:search][:email]).empty? %>
          <% attendee = Attendee.where(email: params[:search][:email]).first if params[:search] %>
          <% if params[:modify].nil? && (SessionAttendee.where(session_id: training.sessions.ids, attendee_id: attendee.id)&.present? || AttendeeInterest.where(attendee_id: attendee.id, session_id: training.sessions.ids))&.present? %>
            <%controller.redirect_to kea_partners_thanks_path(search: {email: attendee.email}) %>
          <% end %>
          <div class='flex-column-between-centered'>
            <%= f.input :firstname, label: 'Prénom', input_html: { value: attendee.firstname, style: 'width:30rem;'}, disabled: true, required: false %>
            <%= f.input :lastname, label: 'Nom', input_html: { value: attendee.lastname, style: 'width:30rem;'}, disabled: true, required: false %>
            <%= f.input :email, input_html: { value: attendee.email, style: 'width:30rem;' }, disabled: true, required: false %>
          </div>
        <% elsif status && Attendee.where(email: params[:search][:email]).empty? %>
          <% controller.redirect_to new_kea_partners_attendee_path(training_id: training.id, email: params[:search][:email]) %>
        <% else %>
          <p>Veuillez entrer votre adresse email pour continuer</p>
          <br>
          <%= f.input :email, label: 'Adresse email' %>
          <p class="center-button"> <%= f.submit 'Connexion', class: 'btn btn-edit-yellow' %> </p>
        <% end %>
      <% end %>
    <% end %>
  </div>
  <% if (params[:search] && !Attendee.where(email: params[:search][:email]).empty?) || user_signed_in? %>
    <div class='container-seven-large-form'>
      <div class="session-form-card-special center-button">
        <div class="session-form-card-left-special">
          <%= image_tag "kea_3.png", style: 'height:100%;width:100%;object-fit:cover;' %>
        </div>
        <div class="session-form-card-right-special">
          <div class="session-form-card-title">
            <h4>Transmettre avec les 7 intelligences</h4>
          </div>
          <p class='session-teaser'>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non consectetur dolor. Donec viverra id libero nec finibus. Aliquam condimentum nec ante tristique euismod.<br><br>Quisque turpis tellus, tristique vitae felis ut, tristique posuere augue. Sed eget nunc at lacus lacinia consectetur ac et arcu. Suspendisse non cursus elit, ut eleifend quam.
          </p>
          <div class="session-form-control flex-column-between-left">
            <%= simple_form_for :create_attendees, url: test_session_attendee_path(attendee_id: attendee.id), method: 'GET' do |f| %>
              <div class="flex-column-between-left">
                <% if SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[4].id, sessions[5].id])&.first&.session_id&.to_s.present? %>
                  <% checked = SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[4].id, sessions[5].id])&.first&.session_id&.to_s %>
                <% elsif AttendeeInterest.where(attendee_id: attendee.id, session_id: sessions[4].id).present? %>
                  <% checked = 'Interested' %>
                <% else %>
                  <% checked = 'Not interested' %>
                <% end %>
                <p class='session-teaser'>Indiquez votre choix pour la date de la formation :</p>
                <%= f.collection_radio_buttons :choice1, [["Le 05 Juin 2020 : 14h-17h (#{sessions[4].attendee_number-sessions[4].attendees.count} places disponibles)", sessions[4].id] ,["Le 10 Juin 2020 : 14h-17h (#{sessions[5].attendee_number-sessions[5].attendees.count} places disponibles)", sessions[5].id], ['Je suis interessé mais pas disponible à ces dates', 'Interested'], ['Je ne souhaite pas participer à cet atelier', 'Not interested']],:last, :first, checked: checked do |b| %>
                  <div class="flex-row-between-centered radio"kea_partners>
                    <p class='form_radio_label'>
                      <label class="radio_container"><%= b.text %>
                        <%= b.radio_button %>
                        <span class="checkmark"></span>
                      </label>
                    </p>
                  </div>
                <% end %>
              </div>
          </div>
        </div>
      </div>
      <div class="session-form-card-special center-button">
        <div class="session-form-card-left-special">
          <%= image_tag "kea_4.png", style: 'height:100%;width:100%;object-fit:cover;' %>
        </div>
        <div class="session-form-card-right-special">
          <div class="session-form-card-title">
            <h4>Préparer une négociation</h4>
          </div>
          <p class='session-teaser'>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non consectetur dolor. Donec viverra id libero nec finibus. Aliquam condimentum nec ante tristique euismod.<br><br>Quisque turpis tellus, tristique vitae felis ut, tristique posuere augue. Sed eget nunc at lacus lacinia consectetur ac et arcu. Suspendisse non cursus elit, ut eleifend quam.
          </p>
          <div class="session-form-control flex-column-between-left">
              <div class="flex-column-between-left">
                <% if SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[6].id, sessions[7].id])&.first&.session_id&.to_s.present? %>
                  <% checked = SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[6].id, sessions[7].id])&.first&.session_id&.to_s %>
                <% elsif AttendeeInterest.where(attendee_id: attendee.id, session_id: sessions[6].id).present? %>
                  <% checked = 'Interested' %>
                <% else %>
                  <% checked = 'Not interested' %>
                <% end %>
                <p class='session-teaser'>Indiquez votre choix pour la date de la formation :</p>
                <%= f.collection_radio_buttons :choice2, [["Le 08 Juin 2020 : 14h-17h (#{sessions[6].attendee_number-sessions[6].attendees.count} places disponibles)", sessions[6].id] ,["Le 11 Juin 2020 : 9h-12h (#{sessions[7].attendee_number-sessions[7].attendees.count} places disponibles)", sessions[7].id], ['Je suis interessé mais pas disponible à ces dates', 'Interested'], ['Je ne souhaite pas participer à cet atelier', 'Not interested']],:last, :first, checked: checked do |b| %>
                  <div class="flex-row-between-centered radio"kea_partners>
                    <p class='form_radio_label'>
                      <label class="radio_container"><%= b.text %>
                        <%= b.radio_button %>
                        <span class="checkmark"></span>
                      </label>
                    </p>
                  </div>
                <% end %>
              </div>
          </div>
        </div>
      </div>
      <div class="session-form-card-special center-button">
        <div class="session-form-card-left-special">
          <%= image_tag "kea_6.jpg", style: 'height:100%;width:100%;object-fit:cover;' %>
        </div>
        <div class="session-form-card-right-special">
          <div class="session-form-card-title">
            <h4>Se connaitre et communiquer</h4>
          </div>
          <p class='session-teaser'>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non consectetur dolor. Donec viverra id libero nec finibus. Aliquam condimentum nec ante tristique euismod.<br><br>Quisque turpis tellus, tristique vitae felis ut, tristique posuere augue. Sed eget nunc at lacus lacinia consectetur ac et arcu. Suspendisse non cursus elit, ut eleifend quam.
          </p>
          <div class="session-form-control flex-column-between-left">
              <div class="flex-column-between-left">
                <% if SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[10].id, sessions[11].id])&.first&.session_id&.to_s.present? %>
                  <% checked = SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[10].id, sessions[11].id])&.first&.session_id&.to_s %>
                <% elsif AttendeeInterest.where(attendee_id: attendee.id, session_id: sessions[10].id).present? %>
                  <% checked = 'Interested' %>
                <% else %>
                  <% checked = 'Not interested' %>
                <% end %>
                <p class='session-teaser'>Indiquez votre choix pour la date de la formation :</p>
                <%= f.collection_radio_buttons :choice3, [["Le 09 Juin 2020 : 14h-17h (#{sessions[10].attendee_number-sessions[10].attendees.count} places disponibles)", sessions[10].id] ,["Le 12 Juin 2020 : 9h-12h (#{sessions[11].attendee_number-sessions[11].attendees.count} places disponibles)", sessions[11].id], ['Je suis interessé mais pas disponible à ces dates', 'Interested'], ['Je ne souhaite pas participer à cet atelier', 'Not interested']],:last, :first, checked: checked do |b| %>
                  <div class="flex-row-between-centered radio"kea_partners>
                    <p class='form_radio_label'>
                      <label class="radio_container"><%= b.text %>
                        <%= b.radio_button %>
                        <span class="checkmark"></span>
                      </label>
                    </p>
                  </div>
                <% end %>
              </div>
          </div>
        </div>
      </div>
      <div class="session-form-card-special center-button">
        <div class="session-form-card-left-special">
          <%= image_tag "kea_7.png", style: 'height:100%;width:100%;object-fit:cover;' %>
        </div>
        <div class="session-form-card-right-special">
          <div class="session-form-card-title">
            <h4>Construire son personal branding</h4>
          </div>
          <p class='session-teaser'>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non consectetur dolor. Donec viverra id libero nec finibus. Aliquam condimentum nec ante tristique euismod.<br><br>Quisque turpis tellus, tristique vitae felis ut, tristique posuere augue. Sed eget nunc at lacus lacinia consectetur ac et arcu. Suspendisse non cursus elit, ut eleifend quam.
          </p>
          <div class="session-form-control flex-column-between-left">
              <div class="flex-column-between-left">
                <% if SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[12].id, sessions[13].id])&.first&.session_id&.to_s.present? %>
                  <% checked = SessionAttendee.where(attendee_id: attendee.id, session_id: [sessions[12].id, sessions[13].id])&.first&.session_id&.to_s %>
                <% elsif AttendeeInterest.where(attendee_id: attendee.id, session_id: sessions[12].id).present? %>
                  <% checked = 'Interested' %>
                <% else %>
                  <% checked = 'Not interested' %>
                <% end %>
                <p class='session-teaser'>Indiquez votre choix pour la date de la formation :</p>
                <%= f.collection_radio_buttons :choice4, [["Le 09 Juin 2020 : 14h-17h (#{sessions[12].attendee_number-sessions[12].attendees.count} places disponibles)", sessions[12].id] ,["Le 12 Juin 2020 : 14h-17h (#{sessions[13].attendee_number-sessions[13].attendees.count} places disponibles)", sessions[13].id], ['Je suis interessé mais pas disponible à ces dates', 'Interested'], ['Je ne souhaite pas participer à cet atelier', 'Not interested']],:last, :first, checked: checked do |b| %>
                  <div class="flex-row-between-centered radio"kea_partners>
                    <p class='form_radio_label'>
                      <label class="radio_container"><%= b.text %>
                        <%= b.radio_button %>
                        <span class="checkmark"></span>
                      </label>
                    </p>
                  </div>
                <% end %>
                <%= hidden_field_tag(:attendee_id, attendee.id) %>
                <%= hidden_field_tag(:sessions_ids, {'choice1'=> [sessions[4].id,sessions[5].id], 'choice2'=> [sessions[6].id,sessions[7].id], 'choice3'=> [sessions[10].id,sessions[11].id], 'choice4'=> [sessions[12].id,sessions[13].id]}) %>
              </div>
          </div>
        </div>
      </div>
              <div class="flex-row-end-centered" style='margin: 3rem 0;'>
                <%= f.submit 'Valider', class: 'btn btn-edit-yellow btn-edit-large btn-submit btn-submit-disabled' %>
              </div>
            <% end %>
    </div>
  <% end %>
</div>

<script>
  button = document.querySelector('.btn-submit');
  button.disabled = true;
  var radio = document.querySelectorAll(".checkmark");
  radio.forEach(function(item){
    item.addEventListener('click', (event) => {
      button.disabled = false;
      button.classList.remove('btn-submit-disabled');
    })
  })
</script>
